<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>GHOSTCORD v3.4</title>
  <style>
    :root {
      --c1: #0ff; --c2: #f0f; --bg: #0a0a0a; --card: #111; --accent: #222; --text: #eee; --border: #333;
      --gold: #ff0; --online: #0f0; --idle: #fa0; --dnd: #f55; --invisible: #666;
    }
    [data-theme="light"] {
      --bg: #f5f5f5; --card: #fff; --accent: #eee; --text: #222; --border: #ccc;
    }
    * { margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI',sans-serif; }
    body { background:var(--bg); color:var(--text); display:flex; flex-direction:column; height:100vh; overflow:hidden; }
    
    /* Top Info Bar */
    #topInfo { background:#000; padding:6px 12px; color:#aaa; font-size:13px; border-bottom:1px solid var(--border); text-align: center; }
    #clock { color:var(--c1); font-weight:600; }

    /* Tabs */
    #tabs { display:flex; background:#000; border-bottom:2px solid var(--c1); }
    .tab { padding:14px 24px; cursor:pointer; font-weight:600; font-size:14px; transition:.2s; }
    .tab:hover { background:var(--accent); }
    .tab.active { background:var(--accent); color:var(--c1); position:relative; }
    .tab.active::after { content:''; position:absolute; bottom:-2px; left:0; width:100%; height:2px; background:var(--c1); }

    /* Content */
    #content { flex:1; display:flex; overflow:hidden; }
    .tab-content { display:none; width:100%; height:100%; flex-direction:column; background:var(--bg); }
    .tab-content.active { display:flex; }

    /* Servers Sidebar */
    #servers { width:72px; background:#000; padding:12px 0; display:flex; flex-direction:column; align-items:center; gap:12px; border-right:1px solid var(--border); overflow-y:auto; }
    .srv { width:48px; height:48px; border-radius:50%; background:var(--c1); cursor:pointer; display:flex; align-items:center; justify-content:center; font-weight:bold; color:#000; box-shadow:0 0 12px rgba(0,255,255,.5); transition:.2s; position:relative; }
    .srv:hover { transform:scale(1.1); border-radius:35%; }
    .srv.add { background:var(--c2); font-size:28px; }
    .srv::after { content:attr(data-name); position:absolute; left:64px; top:50%; transform:translateY(-50%); background:#000; color:#fff; padding:6px 10px; border-radius:4px; font-size:12px; opacity:0; pointer-events:none; transition:.2s; border:1px solid var(--c1); white-space:nowrap; }
    .srv:hover::after { opacity:1; }

    /* Main Area */
    #main { flex:1; display:flex; min-width:0; }
    #channels { width:240px; background:var(--card); padding:16px 8px; border-right:2px solid var(--c1); overflow-y:auto; }
    #channels h3 { color:var(--c1); margin:0 8px 12px; font-size:13px; text-transform:uppercase; letter-spacing:1px; }
    .chan { padding:8px 12px; margin:2px 8px; border-radius:6px; cursor:pointer; transition:.2s; font-size:14px; }
    .chan:hover, .chan.active { background:var(--accent); color:var(--c1); }

    /* Chat */
    #chatArea { flex:1; display:flex; flex-direction:column; background:var(--bg); }
    #messages { flex:1; padding:16px; overflow-y:auto; display:flex; flex-direction:column; gap:10px; }
    .msg { max-width:75%; padding:10px 14px; background:var(--card); border-left:4px solid var(--c1); border-radius:8px; align-self:flex-start; word-wrap:break-word; box-shadow:0 1px 3px rgba(0,0,0,.2); }
    .msg.own { align-self:flex-end; background:#1a1a1a; border-left:none; border-right:4px solid var(--c2); }
    .msg strong { color:var(--c2); }

    #inputArea { display:flex; padding:12px; background:#000; border-top:2px solid var(--c2); gap:8px; align-items:center; }
    #msgInput { flex:1; background:var(--card); border:none; color:var(--text); padding:12px 16px; border-radius:8px; outline:none; font-size:14px; }
    #msgInput:focus { box-shadow:0 0 0 2px var(--c1); }
    #sendBtn { background:var(--c1); color:#000; border:none; padding:0 20px; border-radius:8px; cursor:pointer; font-weight:bold; transition:.2s; }
    #sendBtn:hover { background:#0cc; }

    /* User Panel */
    #userPanel { position:fixed; bottom:0; left:0; width:100%; background:#000; padding:10px 16px; display:flex; align-items:center; gap:12px; border-top:1px solid var(--border); z-index:1000; }
    #userAvatar { width:36px; height:36px; border-radius:50%; background:#555; border:2px solid var(--c1); }
    #userName { font-weight:600; }
    #userStatus { font-size:11px; }

    /* Settings & Nitro */
    .setting { margin:12px 0; }
    .setting label { display:block; margin-bottom:6px; font-weight:600; }
    .setting input, .setting select { width:100%; padding:10px; background:var(--card); border:1px solid var(--border); border-radius:6px; color:var(--text); }
    .friend-req { background:var(--accent); padding:12px; border-radius:8px; margin:8px 0; display:flex; justify-content:space-between; align-items:center; }
    .friend-req button { padding:6px 12px; margin-left:6px; border:none; border-radius:4px; cursor:pointer; font-size:13px; }
    .friend-req .accept { background:#0f0; color:#000; }
    .friend-req .decline { background:#f55; color:#fff; }
    .nitro-btn { background:var(--gold); color:#000; padding:14px 28px; font-weight:bold; border:none; border-radius:8px; cursor:pointer; font-size:16px; margin-top:16px; box-shadow:0 0 15px rgba(255,215,0,.5); transition:.3s; }
    .nitro-btn:hover { transform:scale(1.05); }

    /* Connection Status */
    #connectionStatus { position:fixed; top:10px; right:10px; padding:8px 16px; border-radius:6px; font-size:12px; font-weight:bold; z-index:1000; box-shadow:0 2px 8px rgba(0,0,0,.3); }
    .status-connected { background:#0f0; color:#000; }
    .status-disconnected { background:#f55; color:#fff; }
    .status-connecting { background:#fa0; color:#000; }

    /* Tab content padding */
    .tab-content > div { padding:20px; overflow-y:auto; }
  </style>
</head>
<body data-theme="dark">

  <!-- Top Info: Time + CA -->
  <div id="topInfo">
    <span id="clock"></span> | Country: <strong>CA</strong>
  </div>

  <!-- Connection Status -->
  <div id="connectionStatus" class="status-connecting">Connecting...</div>

  <!-- Tabs -->
  <div id="tabs">
    <div class="tab active" data-tab="home">Home</div>
    <div class="tab" data-tab="servers">Servers</div>
    <div class="tab" data-tab="friends">Friends</div>
    <div class="tab" data-tab="settings">Settings</div>
    <div class="tab" data-tab="nitro">Nitro</div>
  </div>

  <!-- Content -->
  <div id="content">
    <!-- Home -->
    <div id="home" class="tab-content active">
      <div id="servers"></div>
      <div id="main">
        <div id="channels">
          <h3># GENERAL</h3>
          <div class="chan active"># general</div>
          <div class="chan"># random</div>
          <div class="chan"># memes</div>
        </div>
        <div id="chatArea">
          <div id="messages"></div>
          <div id="inputArea">
            <input id="msgInput" placeholder="Message #general..." autocomplete="off"/>
            <button id="sendBtn">SEND</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Servers Tab -->
    <div id="serversTab" class="tab-content">
      <div>
        <h2 style="color:var(--c1)">Server Management</h2>
        <button onclick="addServer()" style="background:var(--c1);color:#000;padding:10px 16px;border:none;border-radius:6px;cursor:pointer;margin-top:12px;">+ Create Server</button>
        <div id="serverList" style="margin-top:20px;display:flex;flex-direction:column;gap:12px;"></div>
      </div>
    </div>

    <!-- Friends Tab -->
    <div id="friendsTab" class="tab-content">
      <div>
        <h2 style="color:var(--c1)">Friends</h2>
        <input id="friendInput" placeholder="Username (exact)" style="width:100%;padding:12px;background:var(--card);color:var(--text);border:1px solid var(--c1);border-radius:6px;margin:12px 0;">
        <button id="addFriendBtn" style="background:var(--c2);color:#000;padding:10px;border:none;border-radius:6px;width:100%;">Send Friend Request</button>
        <div id="friendRequests" style="margin-top:20px;"></div>
        <div id="friendList" style="margin-top:20px;color:#aaa;">No friends yet.</div>
      </div>
    </div>

    <!-- Settings Tab -->
    <div id="settingsTab" class="tab-content">
      <div>
        <h2 style="color:var(--c1)">Settings</h2>
        <div class="setting">
          <label>Name</label>
          <input id="nameInput" placeholder="Your name">
        </div>
        <div class="setting">
          <label>Status</label>
          <select id="statusSelect">
            <option value="online">Online</option>
            <option value="idle">Idle</option>
            <option value="dnd">Do Not Disturb</option>
            <option value="invisible">Invisible</option>
          </select>
        </div>
        <div class="setting">
          <label>Theme</label>
          <select id="themeSelect">
            <option value="dark">Dark</option>
            <option value="light">Light</option>
          </select>
        </div>
        <div class="setting">
          <label>Sound</label>
          <select id="soundSelect">
            <option value="on">On</option>
            <option value="off">Off</option>
          </select>
        </div>
        <button onclick="saveSettings()" style="background:var(--c1);color:#000;padding:10px 16px;border:none;border-radius:6px;margin-top:16px;">Save Settings</button>
      </div>
    </div>

    <!-- Nitro Tab -->
    <div id="nitroTab" class="tab-content">
      <div style="text-align:center;padding-top:40px;">
        <h2 style="color:var(--gold);font-size:28px;text-shadow:0 0 10px var(--gold);">GHOSTCORD NITRO</h2>
        <p style="margin:20px 0;font-size:16px;max-width:500px;margin-left:auto;margin-right:auto;">
          Get <strong>gold name</strong>, <strong>custom emoji</strong>, <strong>server boost</strong>, and more!
        </p>
        <button class="nitro-btn">Get Nitro</button>
      </div>
    </div>
  </div>

  <!-- User Panel -->
  <div id="userPanel">
    <div id="userAvatar"></div>
    <div>
      <div id="userName">Guest</div>
      <div id="userStatus">online</div>
    </div>
  </div>

  <!-- Socket.IO from CDN -->
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <script>
    // CLOCK (CA Time)
    const clockEl = document.getElementById('clock');
    function updateClock() {
      const now = new Date();
      const options = { timeZone: 'America/Toronto', hour: '2-digit', minute: '2-digit', hour12: true };
      const time = now.toLocaleTimeString('en-US', options);
      const date = now.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });
      clockEl.innerHTML = `<strong>${date}</strong> <span style="color:var(--c1);">${time} EST</span>`;
    }
    updateClock();
    setInterval(updateClock, 1000);

    // ⚡ CONNECT TO YOUR SERVER
    const socket = io('http://192.168.12.121:3000');

    // DOM Elements
    const tabs = document.querySelectorAll('.tab');
    const contents = document.querySelectorAll('.tab-content');
    const srvList = document.getElementById('servers');
    const msgsDiv = document.getElementById('messages');
    const input = document.getElementById('msgInput');
    const sendBtn = document.getElementById('sendBtn');
    const userNameEl = document.getElementById('userName');
    const userStatusEl = document.getElementById('userStatus');
    const connectionStatus = document.getElementById('connectionStatus');
    const friendInput = document.getElementById('friendInput');
    const addFriendBtn = document.getElementById('addFriendBtn');
    const friendRequestsDiv = document.getElementById('friendRequests');
    const friendListDiv = document.getElementById('friendList');

    let myName = prompt("Enter your name:") || "Guest";
    userNameEl.textContent = myName;
    document.getElementById('nameInput').value = myName;

    // Connection Status
    socket.on('connect', () => {
      console.log('✅ Connected!');
      connectionStatus.textContent = 'Connected';
      connectionStatus.className = 'status-connected';
      socket.emit('setUser', { name: myName });
    });

    socket.on('disconnect', () => {
      console.log('❌ Disconnected');
      connectionStatus.textContent = 'Disconnected';
      connectionStatus.className = 'status-disconnected';
    });

    socket.on('connect_error', (error) => {
      console.error('Connection error:', error);
      connectionStatus.textContent = 'Connection Failed';
      connectionStatus.className = 'status-disconnected';
    });

    // Tab Switching
    tabs.forEach(tab => {
      tab.onclick = () => {
        tabs.forEach(t => t.classList.remove('active'));
        contents.forEach(c => c.classList.remove('active'));
        tab.classList.add('active');
        
        // Map tab names to content IDs
        const tabMap = {
          'home': 'home',
          'servers': 'serversTab',
          'friends': 'friendsTab',
          'settings': 'settingsTab',
          'nitro': 'nitroTab'
        };
        const contentId = tabMap[tab.dataset.tab];
        if (contentId) {
          document.getElementById(contentId).classList.add('active');
        }
      };
    });

    // Chat Functions
    function sendMsg() {
      const txt = input.value.trim();
      if (txt) {
        socket.emit('sendMsg', { text: txt });
        input.value = '';
      }
    }
    sendBtn.onclick = sendMsg;
    input.addEventListener('keydown', e => { if (e.key === 'Enter') sendMsg(); });

    socket.on('msg', d => {
      const isOwn = d.msg.user === myName;
      const m = document.createElement('div');
      m.className = `msg ${isOwn ? 'own' : ''}`;
      const timeStr = d.msg.time ? `[${d.msg.time}] ` : '';
      m.innerHTML = `<strong>${timeStr}${d.msg.user}:</strong> ${d.msg.text}`;
      msgsDiv.appendChild(m);
      msgsDiv.scrollTop = msgsDiv.scrollHeight;
    });

    // Friend Requests
    addFriendBtn.onclick = () => {
      const target = friendInput.value.trim();
      if (target && target !== myName) {
        socket.emit('friendRequest', target);
        friendInput.value = '';
      }
    };

    socket.on('friendRequest', data => {
      const req = document.createElement('div');
      req.className = 'friend-req';
      req.innerHTML = `
        <span><strong>${data.from}</strong> sent a friend request</span>
        <div>
          <button class="accept" onclick="acceptFriend('${data.fromId}')">Accept</button>
          <button class="decline" onclick="declineFriend('${data.fromId}')">Decline</button>
        </div>
      `;
      friendRequestsDiv.appendChild(req);
    });

    window.acceptFriend = id => { 
      socket.emit('acceptFriend', id); 
      friendRequestsDiv.innerHTML = ''; 
    };
    
    window.declineFriend = id => { 
      socket.emit('declineFriend', id); 
      friendRequestsDiv.innerHTML = ''; 
    };

    socket.on('friendAccepted', data => {
      friendListDiv.innerHTML += `<div style="padding:8px;background:var(--accent);border-radius:6px;margin:4px 0;">${data.name} (Friend)</div>`;
    });

    // Settings
    window.saveSettings = () => {
      myName = document.getElementById('nameInput').value.trim() || "Guest";
      const status = document.getElementById('statusSelect').value;
      const theme = document.getElementById('themeSelect').value;
      document.body.dataset.theme = theme;
      userNameEl.textContent = myName;
      userStatusEl.textContent = status;
      
      const statusColors = {
        'online': '#0f0',
        'idle': '#fa0',
        'dnd': '#f55',
        'invisible': '#666'
      };
      userStatusEl.style.color = statusColors[status];
      
      socket.emit('setUser', { name: myName });
      alert("Settings saved!");
    };

    // Server Management
    window.addServer = () => {
      const name = prompt("Server name:");
      if (name) {
        const srv = document.createElement('div');
        srv.className = 'srv';
        srv.textContent = name.charAt(0).toUpperCase();
        srv.dataset.name = name;
        srv.onclick = () => alert(`Switched to: ${name}`);
        srvList.insertBefore(srv, srvList.lastElementChild);
      }
    };

    // Add + button for servers
    const addSrv = document.createElement('div');
    addSrv.className = 'srv add';
    addSrv.textContent = '+';
    addSrv.onclick = window.addServer;
    srvList.appendChild(addSrv);

    // Home server
    const homeSrv = document.createElement('div');
    homeSrv.className = 'srv';
    homeSrv.textContent = 'H';
    homeSrv.dataset.name = 'Home';
    homeSrv.style.background = '#0f0';
    srvList.insertBefore(homeSrv, addSrv);
  </script>
</body>
</html>